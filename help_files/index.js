!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).verne=t()}(this,(function(){"use strict";var e=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")};function t(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var a=function(e,a,n){return a&&t(e.prototype,a),n&&t(e,n),e},n=function(){function t(){e(this,t),this.eventLoadDataLayerName="loadDataLayer",this.fifo=[],this.cleanedFifos=[],this.init()}return a(t,[{key:"isLoaded",value:function(){var e=this;return window.dataLayer.some((function(t){return t.event===e.eventLoadDataLayerName}))}},{key:"init",value:function(){window.dataLayer||(window.dataLayer=[]),this.dataLayerListener(window.dataLayer)}},{key:"dataLayerListener",value:function(e){var t=this,a=e;a.push=function(e){if(Array.prototype.push.call(a,e),t.isLoaded())t.fifo.length>0&&t.fifo.forEach((function(){var e=t.fifo.shift();t.cleanedFifos.push(e),window.dataLayer.push(e)}));else{var n=Array.prototype.pop.call(a,e);t.fifo.push(n)}}}},{key:"push",value:function(e){var t=e();t&&(this.isLoaded()?window.dataLayer.push(t):this.fifo.push(t))}}]),t}();return(new(function(){function t(){e(this,t);var a=window.dataLayerV2Json;return this.application=a&&a.server&&a.server.application,this.brandID=a&&a.page&&a.page.brandID,this.countryID=a&&a.shop&&a.shop.countryID,this.countryISO=a&&a.shop&&a.shop.countryISO,this.languageISO=a&&a.shop&&a.shop.languageISO,this.languageID=a&&a.shop&&a.shop.languageID,this.externalID=a&&a.user&&a.user.externalID,this.firstName=a&&a.user&&a.user.firstName,this.logged=a&&a.user&&a.user.logged,this.mail=a&&a.user&&a.user.mail,this}return a(t,[{key:"setData",value:function(){return function(e,t){try{return localStorage.setItem(e,t),!0}catch(e){throw new Error("Error set")}}("mdm",JSON.stringify(this))}}]),t}())).setData(),{analytics:new n}}));
